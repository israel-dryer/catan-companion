import{a as ne,b as oe}from"./chunk-WTY6MB72.js";import{a as I,b as ie}from"./chunk-4HHYV5DL.js";import{a as _,b as te}from"./chunk-OI36OCLG.js";import{a as v}from"./chunk-OGSRTT4J.js";import{C as x,D as y,Eb as K,Fa as j,Gb as Q,Hb as X,K as p,Kb as Y,Nb as Z,Ob as ee,Qa as N,R as w,T as h,U as C,V as R,W as L,X as B,Y as e,Z as t,_ as b,c as P,ca as E,da as g,ea as f,f as A,ma as o,mb as U,na as F,qa as O,rb as H,sb as J,ta as S,ua as u,ub as M,vb as W,wb as q,x as k,xb as z,y as $,zb as G}from"./chunk-PV5YSWZ3.js";import"./chunk-WUWNYIGP.js";import"./chunk-LWVDKAUF.js";import"./chunk-GL44O5XQ.js";import"./chunk-RJAJR2VM.js";import"./chunk-F7XBNY6P.js";import"./chunk-VMJYD4Q3.js";import"./chunk-ECOWT7JY.js";import"./chunk-V7Y3NHWF.js";import"./chunk-4U6PRYVA.js";import"./chunk-ZAB4NJP7.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{h as d}from"./chunk-HCV7W5KS.js";var V=v("Filesystem",{web:()=>import("./chunk-HJEQVBGP.js").then(a=>new a.FilesystemWeb)});var ae=v("Device",{web:()=>import("./chunk-RRCXPYJU.js").then(a=>new a.DeviceWeb)});var re=v("Share",{web:()=>import("./chunk-2S7AJUF2.js").then(a=>new a.ShareWeb)});function le(a,c){if(a&1&&(e(0,"ion-select-option",15),o(1),t()),a&2){let l=c.$implicit;h("value",l),p(),F(l)}}function se(a,c){if(a&1){let l=E();e(0,"ion-item")(1,"ion-select",14),S(2,"async"),g("ionChange",function(r){x(l);let i=f(2);return y(i.updateSelectedVoice(r))}),L(3,le,2,2,"ion-select-option",15,R),t()()}if(a&2){let l=f(2);p(),h("value",u(2,1,l.$selectedVoice)),p(2),B(l.availableVoices)}}function ce(a,c){if(a&1){let l=E();e(0,"ion-item")(1,"ion-toggle",6),S(2,"async"),g("ionChange",function(r){x(l);let i=f();return y(i.toggleAnnounceDiceRoll(r))}),e(3,"ion-label"),o(4,"Speak Dice Total"),t(),e(5,"ion-note"),o(6,"Speak sum of the dice roll"),t()()(),w(7,se,5,3,"ion-item"),S(8,"async")}if(a&2){let l=f();p(),h("checked",u(2,2,l.$speechEnabled)),p(6),C(u(8,4,l.$speechEnabled)?7:-1)}}function pe(a,c){if(a&1){let l=E();e(0,"ion-item",12),g("click",function(){x(l);let r=f();return y(r.exportApplicationData())}),b(1,"ion-icon",16),e(2,"ion-label")(3,"h2"),o(4,"Share App Data"),t(),e(5,"ion-note"),o(6,"Export to JSON and share"),t()()()}}function de(a,c){if(a&1){let l=E();e(0,"ion-item",12),g("click",function(){x(l);let r=f();return y(r.exportApplicationData())}),b(1,"ion-icon",17),e(2,"ion-label")(3,"h2"),o(4,"Export App Data"),t(),e(5,"ion-note"),o(6,"Export to JSON"),t()()()}}var Oe=(()=>{let c=class c{constructor(){this.settingService=k(ie),this.storageService=k(te),this.$speechAvailable=_(()=>this.settingService.get("speechAvailable")),this.$rollingDiceSoundEnabled=_(()=>this.settingService.get("rollingDiceSoundEnabled")),this.$robberLaughSoundEnabled=_(()=>this.settingService.get("robberLaughSoundEnabled")),this.$speechEnabled=_(()=>this.settingService.get("speechEnabled")),this.$hapticsEnabled=_(()=>this.settingService.get("hapticsEnabled")),this.$showDiceTotal=_(()=>this.settingService.get("showDiceTotal")),this.isAndroid=!1,this.availableVoices=[],this.$selectedVoice=P(_(()=>this.settingService.get("speechVoice"))).pipe(A(n=>n.name)),this.toggleRollingDiceSound=r=>d(this,[r],function*({detail:n}){yield this.settingService.put("rollingDiceSoundEnabled",n.checked)}),this.toggleRobberLaughSound=r=>d(this,[r],function*({detail:n}){yield this.settingService.put("robberLaughSoundEnabled",n.checked)}),this.updateSelectedVoice=r=>d(this,[r],function*({detail:n}){let i=n.value;I.getSupportedVoices().then(m=>{let s=m.voices.findIndex(D=>D.voiceURI===i);this.settingService.put("speechVoice",{name:i,index:s})})}),this.toggleAnnounceDiceRoll=r=>d(this,[r],function*({detail:n}){yield this.settingService.put("speechEnabled",n.checked)}),this.toggleHaptics=r=>d(this,[r],function*({detail:n}){yield this.settingService.put("hapticsEnabled",n.checked)}),this.toggleDiceTotal=r=>d(this,[r],function*({detail:n}){yield this.settingService.put("showDiceTotal",n.checked)}),this.resetAppSettings=()=>d(this,null,function*(){yield this.settingService.reset()}),this.exportApplicationData=()=>d(this,null,function*(){let n=yield this.storageService.db.settings.toArray(),r=yield this.storageService.db.games.toArray(),i=yield this.storageService.db.current.toArray(),m=yield this.storageService.db.players.toArray();if(this.isAndroid){yield V.requestPermissions();try{let s=yield V.writeFile({path:"catan/catan_app_data.json",data:JSON.stringify({settings:n,games:r,current:i,players:m}),directory:ne.Cache,encoding:oe.UTF8,recursive:!0});yield re.share({url:s.uri})}catch(s){alert(s)}}else{let s=new Blob([JSON.stringify({settings:n,games:r,current:i,players:m})],{type:"application/json"}),D=URL.createObjectURL(s),T=document.createElement("a");T.download="catan_app_data.json",T.href=D,T.click()}})}ngOnInit(){return d(this,null,function*(){this.isAndroid=(yield ae.getInfo()).operatingSystem==="android";let n=navigator.languages;I.getSupportedVoices().then(r=>{r.voices.filter(i=>n.includes(i.lang)&&i.localService).forEach(i=>this.availableVoices.push(i.voiceURI))})})}};c.\u0275fac=function(r){return new(r||c)},c.\u0275cmp=$({type:c,selectors:[["app-settings"]],standalone:!0,features:[O],decls:67,vars:17,consts:[[3,"translucent"],["slot","start"],["default-href","/"],["collapse","condense"],["size","large"],["inset",""],["color","success",3,"ionChange","checked"],["button","","routerLink","/purge-game-data"],["name","trash","slot","start"],["button","","routerLink","/edit-players"],["name","person-add","slot","start"],["button",""],["button","",3,"click"],["name","refresh","slot","start"],["label","Selected Voice","labelPlacement","floating",3,"ionChange","value"],[3,"value"],["name","share-social","slot","start"],["name","download","slot","start"]],template:function(r,i){r&1&&(e(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),b(3,"ion-back-button",2),t(),e(4,"ion-title"),o(5,"Settings"),t()()(),e(6,"ion-content")(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),o(10,"Settings"),t()()(),e(11,"ion-list",5)(12,"ion-item")(13,"ion-toggle",6),S(14,"async"),g("ionChange",function(s){return i.toggleRollingDiceSound(s)}),e(15,"ion-label"),o(16,"Rolling Dice Sound"),t(),e(17,"ion-note"),o(18,"Sound effect for rolling dice"),t()()(),e(19,"ion-item")(20,"ion-toggle",6),S(21,"async"),g("ionChange",function(s){return i.toggleRobberLaughSound(s)}),e(22,"ion-label"),o(23,"Robber Laugh Sound"),t(),e(24,"ion-note"),o(25,"Sound effect when 7 is rolled"),t()()(),e(26,"ion-item")(27,"ion-toggle",6),S(28,"async"),g("ionChange",function(s){return i.toggleDiceTotal(s)}),e(29,"ion-label"),o(30,"Show Dice Total"),t(),e(31,"ion-note"),o(32,"Display sum of dice"),t()()(),e(33,"ion-item")(34,"ion-toggle",6),S(35,"async"),g("ionChange",function(s){return i.toggleHaptics(s)}),e(36,"ion-label"),o(37,"Enable Haptics"),t(),e(38,"ion-note"),o(39,"Vibrate device on dice roll"),t()()(),w(40,ce,9,6),S(41,"async"),t(),e(42,"ion-list",5)(43,"ion-item",7),b(44,"ion-icon",8),e(45,"ion-label")(46,"h2"),o(47,"Purge"),t(),e(48,"ion-note"),o(49,"Delete selected game data"),t()()()(),e(50,"ion-list",5)(51,"ion-item",9),b(52,"ion-icon",10),e(53,"ion-label")(54,"h2"),o(55,"Manage Players"),t(),e(56,"ion-note"),o(57,"Add or remove players"),t()()(),w(58,pe,7,0,"ion-item",11)(59,de,7,0,"ion-item",11),e(60,"ion-item",12),g("click",function(){return i.resetAppSettings()}),b(61,"ion-icon",13),e(62,"ion-label")(63,"h2"),o(64,"Reset Settings"),t(),e(65,"ion-note"),o(66,"Reset all app settings"),t()()()()()),r&2&&(h("translucent",!0),p(13),h("checked",u(14,7,i.$rollingDiceSoundEnabled)),p(7),h("checked",u(21,9,i.$robberLaughSoundEnabled)),p(7),h("checked",u(28,11,i.$showDiceTotal)),p(7),h("checked",u(35,13,i.$hapticsEnabled)),p(6),C(u(41,15,i.$speechAvailable)?40:-1),p(18),C(i.isAndroid?58:59))},dependencies:[M,X,H,U,Q,J,z,W,ee,q,j,G,Y,N,Z,K]});let a=c;return a})();export{Oe as SettingsPage};
