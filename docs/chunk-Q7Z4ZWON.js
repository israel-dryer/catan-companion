import{a as Q}from"./chunk-FNEONL4B.js";import"./chunk-GIDP7GDQ.js";import{a as V}from"./chunk-RW7D7ZYR.js";import"./chunk-Z3GWI56J.js";import"./chunk-F43FBNYM.js";import"./chunk-QTVGTTQH.js";import"./chunk-TVLZZ6SX.js";import"./chunk-3DFML6UE.js";import"./chunk-HC6MZPB3.js";import"./chunk-YMI2B6JE.js";import"./chunk-BJUAS447.js";import"./chunk-FERD25SW.js";import"./chunk-5SST7FTL.js";import"./chunk-2UWZ4B5Y.js";import"./chunk-W2I4VDZA.js";import"./chunk-MCRJI3T3.js";import{b as H}from"./chunk-4HHYV5DL.js";import"./chunk-LQVFMVUB.js";import{a as W}from"./chunk-OI36OCLG.js";import{a as $}from"./chunk-OGSRTT4J.js";import"./chunk-4QQZBZ4S.js";import"./chunk-MEPF3XFJ.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import{c as P,d as A,f as s,g as D,h as E,i as G}from"./chunk-5IC5DNT2.js";import{Da as T,Fb as K,K as p,Ka as O,Kb as U,Pa as M,Qa as I,R as v,T as l,U as h,Y as r,Z as a,_ as c,da as R,ea as d,ma as y,na as w,nb as L,qa as C,qb as B,sa as f,sb as F,tb as N,ub as j,x as S,y as _,zb as z}from"./chunk-PV5YSWZ3.js";import"./chunk-WUWNYIGP.js";import"./chunk-LWVDKAUF.js";import"./chunk-GL44O5XQ.js";import"./chunk-RJAJR2VM.js";import"./chunk-F7XBNY6P.js";import"./chunk-VMJYD4Q3.js";import"./chunk-ECOWT7JY.js";import"./chunk-V7Y3NHWF.js";import"./chunk-4U6PRYVA.js";import"./chunk-ZAB4NJP7.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{h as g}from"./chunk-HCV7W5KS.js";var b=$("KeepAwake",{web:()=>import("./chunk-BFF7YOYS.js").then(e=>new e.KeepAwakeWeb)});var x=e=>({backgroundColor:e});function te(e,t){if(e&1&&(r(0,"div",0),c(1,"div",1),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function ie(e,t){if(e&1&&(r(0,"div",0),c(1,"div",2)(2,"div",3),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function ne(e,t){if(e&1&&(r(0,"div",0),c(1,"div",2)(2,"div",1)(3,"div",3),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function oe(e,t){if(e&1&&(r(0,"div",0),c(1,"div",2)(2,"div",4)(3,"div",5)(4,"div",3),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function re(e,t){if(e&1&&(r(0,"div",0),c(1,"div",2)(2,"div",4)(3,"div",1)(4,"div",5)(5,"div",3),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function ae(e,t){if(e&1&&(r(0,"div",0),c(1,"div",2)(2,"div",4)(3,"div",6)(4,"div",7)(5,"div",5)(6,"div",3),a()),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}function le(e,t){if(e&1&&c(0,"div",0),e&2){let i=d();l("ngStyle",f(1,x,i.dieColor))}}var J=(()=>{let t=class t{constructor(){this.red="",this.gold=""}ngAfterViewInit(){this.red=getComputedStyle(document.documentElement).getPropertyValue("--ion-color-danger"),this.gold=getComputedStyle(document.documentElement).getPropertyValue("--ion-color-warning")}get dieColor(){return this.color==="red"?this.red:this.gold}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=_({type:t,selectors:[["app-dice"]],inputs:{number:"number",color:"color"},standalone:!0,features:[C],decls:7,vars:1,consts:[[1,"dice",3,"ngStyle"],[1,"dot",2,"grid-row","2","grid-column","2"],[1,"dot",2,"grid-row","1","grid-column","1"],[1,"dot",2,"grid-row","3","grid-column","3"],[1,"dot",2,"grid-row","1","grid-column","3"],[1,"dot",2,"grid-row","3","grid-column","1"],[1,"dot",2,"grid-row","2","grid-column","1"],[1,"dot",2,"grid-row","2","grid-column","3"]],template:function(o,n){if(o&1&&v(0,te,2,3,"div",0)(1,ie,3,3,"div",0)(2,ne,4,3,"div",0)(3,oe,5,3,"div",0)(4,re,6,3,"div",0)(5,ae,7,3,"div",0)(6,le,1,3,"div",0),o&2){let u;h((u=n.number)===1?0:u===2?1:u===3?2:u===4?3:u===5?4:u===6?5:6)}},dependencies:[T],styles:[".dice[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:10%;box-sizing:border-box;padding:8%;aspect-ratio:1;display:grid;grid-template-rows:repeat(3,1fr);grid-template-columns:repeat(3,1fr);align-items:center;justify-items:center}.dot[_ngcontent-%COMP%]{display:block;border-radius:50%;width:80%;height:auto;aspect-ratio:1;background-color:var(--ion-background-color)}"]});let e=t;return e})();function ce(e,t){if(e&1&&c(0,"img",1),e&2){let i=d();l("ngSrc",i.DiceActionResource.BARBARIAN)("priority",!0)}}function se(e,t){if(e&1&&c(0,"img",2),e&2){let i=d();l("ngSrc",i.DiceActionResource.BLUE)("priority",!0)}}function de(e,t){if(e&1&&c(0,"img",3),e&2){let i=d();l("ngSrc",i.DiceActionResource.GREEN)("priority",!0)}}function me(e,t){if(e&1&&c(0,"img",4),e&2){let i=d();l("ngSrc",i.DiceActionResource.GOLD)("priority",!0)}}var X=function(e){return e.BARBARIAN="/assets/cities-knights-barbarian.svg",e.BLUE="/assets/cities-knights-blue.svg",e.GOLD="/assets/cities-knights-gold.svg",e.GREEN="/assets/cities-knights-green.svg",e}(X||{}),Y=function(e){return e.GOLD="GLD",e.GREEN="GRN",e.BLUE="BLU",e.BARBARIAN="BAR",e}(Y||{}),Z=(()=>{let t=class t{constructor(){this.DiceAction=Y,this.DiceActionResource=X}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=_({type:t,selectors:[["app-action-dice"]],inputs:{action:"action"},standalone:!0,features:[C],decls:6,vars:1,consts:[[1,"dice"],["width","96","height","96","alt","barbarian dice",3,"ngSrc","priority"],["width","96","height","96","alt","blue building dice",3,"ngSrc","priority"],["width","96","height","96","alt","green building dice",3,"ngSrc","priority"],["width","96","height","96","alt","gold building dice",3,"ngSrc","priority"]],template:function(o,n){if(o&1&&(r(0,"div",0),v(1,ce,1,2,"img",1)(2,se,1,2,"img",2)(3,de,1,2,"img",3)(4,me,1,2,"img",4),y(5,`)
`),a()),o&2){let u;p(),h((u=n.action)===n.DiceAction.BARBARIAN?1:u===n.DiceAction.BLUE?2:u===n.DiceAction.GREEN?3:u===n.DiceAction.GOLD?4:-1)}},dependencies:[O],styles:[".dice[_ngcontent-%COMP%]{border-radius:8%;padding:2rem;background-color:#fff;display:grid;place-items:center;width:100%;height:100%}@media screen and (orientation: landscape){img[_ngcontent-%COMP%]{width:100%;height:auto}}@media screen and (orientation: portrait){img[_ngcontent-%COMP%]{width:auto;height:100%}}"]});let e=t;return e})();var pe=e=>["/reports",e];function ue(e,t){if(e&1&&(r(0,"div",4)(1,"div",19),y(2),a()()),e&2){let i=d();p(2),w(i.lastRoll==null?null:i.lastRoll.total)}}function ge(e,t){if(e&1&&(r(0,"ion-text",6),y(1),a()),e&2){let i=d();p(),w(i.playService.prevPlayer)}}function fe(e,t){if(e&1&&c(0,"app-action-dice",9),e&2){let i=d();l("action",i.lastRoll==null?null:i.lastRoll.action)("@jiggleGold",i.isRolling?"active":"")}}function ve(e,t){if(e&1&&(r(0,"ion-text",11),y(1),a()),e&2){let i=d();p(),w(i.lastRoll==null?null:i.lastRoll.total)}}var k=750,Be=(()=>{let t=class t{constructor(){this.alertController=S(V),this.settingsService=S(H),this.router=S(M),this.isRolling=!1,this.playService=S(Q),this.$showDiceTotal=W(()=>this.settingsService.get("showDiceTotal")),this.actionSheetButtons=[{text:"Undo last roll",icon:"arrow-undo",data:{action:"undo"}},{text:"End game",icon:"trophy",data:{action:"end"}},{text:"History",icon:"timer",data:{action:"history"}},{text:"Settings",icon:"options",data:{action:"settings"}},{text:"Cancel",role:"cancel",icon:"close",data:{action:"cancel"}}]}get lastRoll(){var m;return(m=this.playService.activeGame)==null?void 0:m.rolls.at(-1)}get activeGame(){return this.playService.activeGame}ionViewWillEnter(){return g(this,null,function*(){b.isSupported().then(m=>g(this,null,function*(){m.isSupported&&(yield b.keepAwake())}))})}ionViewWillLeave(){return g(this,null,function*(){b.isSupported().then(m=>g(this,null,function*(){m.isSupported&&(yield b.allowSleep())}))})}rollDice(){return g(this,null,function*(){this.playService.currPlayer&&!this.isRolling&&(this.isRolling=!0,yield this.playService.roll(),setTimeout(()=>this.isRolling=!1,k))})}closeActionSheet(m){return g(this,null,function*(){var o;switch((o=m.detail.data)==null?void 0:o.action){case"undo":yield this.undoLastRoll();break;case"end":yield this.endGame();break;case"settings":yield this.router.navigate(["settings"]);break;case"history":yield this.router.navigate(["history"]);break;default:break}})}endGame(){return g(this,null,function*(){let m=yield this.alertController.create({message:"Choose a winner (optional)",buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",role:"confirm"}],inputs:this.playService.activeGame.roster.map(o=>({label:o,type:"radio",value:o}))});m.onDidDismiss().then(o=>g(this,null,function*(){if(o.role!=="cancel"){let n=o.data.values;yield this.playService.endActiveGame(n),yield this.router.navigate(["home"])}})),yield m.present()})}undoLastRoll(){return g(this,null,function*(){yield this.playService.undoLastRoll()})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=_({type:t,selectors:[["app-play"]],standalone:!0,features:[C],decls:25,vars:14,consts:[[1,"header-row"],[1,"next-player","ion-text-uppercase"],[1,"ion-text-uppercase"],["color","warning",2,"font-size","1.4rem"],[1,"ion-text-center","ion-text-uppercase",2,"align-items","center","grid-column","2"],[1,"prev-player","ion-text-end","ion-text-uppercase",2,"grid-column","3"],[2,"font-size","1.4rem"],[1,"ion-padding",3,"click","fullscreen"],[1,"dice-container"],[3,"action"],["color","red",3,"number"],[1,"center-roll-total"],["color","gold",3,"number"],[1,"button-row"],["fill","clear","color","medium","size","large",3,"routerLink"],["slot","icon-only","name","bar-chart"],["fill","clear","color","medium","id","present-settings","size","large"],["slot","icon-only","name","settings"],["trigger","present-settings",3,"didDismiss","buttons"],[2,"font-size","2.25rem","font-weight","bold"]],template:function(o,n){o&1&&(r(0,"ion-header")(1,"div",0)(2,"div",1)(3,"ion-note",2),y(4,"Next"),a(),r(5,"ion-text",3),y(6),a()(),v(7,ue,3,1,"div",4),r(8,"div",5)(9,"ion-note"),y(10,"Prev"),a(),v(11,ge,2,1,"ion-text",6),a()()(),r(12,"ion-content",7),R("click",function(){return n.rollDice()}),r(13,"div",8),v(14,fe,1,2,"app-action-dice",9),c(15,"app-dice",10),v(16,ve,2,1,"ion-text",11),c(17,"app-dice",12),a()(),r(18,"ion-footer")(19,"div",13)(20,"ion-button",14),c(21,"ion-icon",15),a(),r(22,"ion-button",16),c(23,"ion-icon",17),a()(),r(24,"ion-action-sheet",18),R("didDismiss",function(ee){return n.closeActionSheet(ee)}),a()()),o&2&&(p(6),w(n.playService.currPlayer),p(),h(n.activeGame!=null&&n.activeGame.citiesAndKnights?7:-1),p(4),h(!(n.activeGame==null||n.activeGame.rolls==null)&&n.activeGame.rolls.length?11:-1),p(),l("fullscreen",!0),p(2),h(n.activeGame!=null&&n.activeGame.citiesAndKnights?14:-1),p(),l("number",n.lastRoll==null?null:n.lastRoll.dice1)("@jiggleRed",n.isRolling?"active":""),p(),h(n.activeGame!=null&&n.activeGame.citiesAndKnights?-1:16),p(),l("number",n.lastRoll==null?null:n.lastRoll.dice2)("@jiggleGold",n.isRolling?"active":""),p(3),l("routerLink",f(12,pe,n.activeGame==null?null:n.activeGame.id)),p(4),l("buttons",n.actionSheetButtons))},dependencies:[F,z,K,J,B,I,U,L,Z,N,j],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.header-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);padding:.5rem 1rem}.button-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.next-player[_ngcontent-%COMP%], .prev-player[_ngcontent-%COMP%]{display:flex;flex-direction:column}.dice-container[_ngcontent-%COMP%]{display:flex;gap:1.5rem;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;padding:2rem}app-action-dice[_ngcontent-%COMP%], app-dice[_ngcontent-%COMP%]{height:100%;width:auto;aspect-ratio:1}.center-roll-total[_ngcontent-%COMP%]{font-size:6vh;font-weight:700;width:3em;text-align:center;line-height:1em}@media screen and (orientation: landscape){.dice-container[_ngcontent-%COMP%]{flex-direction:row}app-action-dice[_ngcontent-%COMP%], app-dice[_ngcontent-%COMP%]{height:auto;max-height:calc(100vh - 130px);max-width:calc(100vh - 130px);width:100%}.center-roll-total[_ngcontent-%COMP%]{font-size:6vw}}"],data:{animation:[P("jiggleRed",[D("active",s({})),G("* => active",[A(`${k}ms`,E([s({transform:"translate3d(0, 0, 0) rotate(0deg)"}),s({transform:"translate3d(-1px, 0, 0) rotate(-5deg)"}),s({transform:"translate3d(2px, 0, 0) rotate(0deg)"}),s({transform:"translate3d(-4px, 0, 0)"}),s({transform:"translate3d(4px, 0, 0) rotate(5deg)"}),s({transform:"translate3d(1px, 0, 0) rotate(5deg)"}),s({transform:"translate3d(-2px, 0, 0) rotate(0deg)"}),s({transform:"translate3d(4px, 0, 0)"})]))])]),P("jiggleGold",[D("active",s({})),G("* => active",[A(`${k}ms`,E([s({transform:"translate3d(0, 0, 0) rotate(0deg)"}),s({transform:"translate3d(1px, 0, 0) rotate(5deg)"}),s({transform:"translate3d(-2px, 0, 0) rotate(0deg)"}),s({transform:"translate3d(4px, 0, 0)"}),s({transform:"translate3d(-4px, 0, 0) rotate(-5deg)"}),s({transform:"translate3d(1px, 0, 0) rotate(5deg)"}),s({transform:"translate3d(-2px, 0, 0) rotate(0deg)"}),s({transform:"translate3d(4px, 0, 0)"})]))])])]}});let e=t;return e})();export{Be as PlayPage};
